{% extends "_layout.njk" %}

{% set headerNavId = "account" %}

{% set title = "Your email notifications" %}
{#% set caption = user.firstName + " " + user.lastName %#}

{% block beforeContent %}
{{ govukBreadcrumbs({
  items: [{
    text: "Your account",
    href: "/account"
  }, {
    text: title
  }]
}) }}
{% endblock %}

{% block content %}

  {% include "_includes/notification-banner.njk" %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <h1 class="govuk-heading-l">
        {% if caption.length %}
          <span class="govuk-caption-l">
            {{ caption }}
          </span>
        {% endif %}
        {{ title }}
      </h1>

      {% for organisation in user.organisations %}

        {% if user.organisations.length > 1 %}
          <h2 class="govuk-heading-m {{- ' govuk-!-margin-top-9' if loop.index > 1 }}">{{ organisation.name }}</h2>
        {% endif %}

        <dl class="govuk-summary-list">
          {% for notification in notificationOptions %}
            <div class="govuk-summary-list__row">
              <dt class="govuk-summary-list__key">
                {{ notification.name }}
              </dt>
              <dd class="govuk-summary-list__value">
                {{ "Yes" if (organisation.notifications and notification.code in organisation.notifications) else "No" }}
              </dd>
              <dd class="govuk-summary-list__actions">
                <a class="govuk-link" href="/account/notifications/organisations/{{ organisation.id }}/edit">
                  Change<span class="govuk-visually-hidden"> {{ organisation.name }} email notifications</span>
                </a>
              </dd>
            </div>
          {% endfor %}
        </dl>

      {% endfor %}

    </div>
  </div>

{% endblock %}
